function fixdata(e){for(var r="",t=0,a=10240;t<e.byteLength/a;++t)r+=String.fromCharCode.apply(null,new Uint8Array(e.slice(t*a,t*a+a)));return r+=String.fromCharCode.apply(null,new Uint8Array(e.slice(t*a)))}function ab2str(e){for(var r="",t=0,a=10240;t<e.byteLength/a;++t)r+=String.fromCharCode.apply(null,new Uint16Array(e.slice(t*a,t*a+a)));return r+=String.fromCharCode.apply(null,new Uint16Array(e.slice(t*a)))}function s2ab(e){for(var r=new ArrayBuffer(2*e.length),t=new Uint16Array(r),a=0;a!=e.length;++a)t[a]=e.charCodeAt(a);return[t,r]}function xw_noxfer(e,r){var t=new Worker(XW.noxfer);t.onmessage=function(e){switch(e.data.t){case"ready":break;case"e":console.error(e.data.d);break;case XW.msg:r(JSON.parse(e.data.d))}};var a=rABS?e:btoa(fixdata(e));t.postMessage({d:a,b:rABS})}function xw_xfer(e,r){var t=new Worker(rABS?XW.rABS:XW.norABS);if(t.onmessage=function(e){switch(e.data.t){case"ready":break;case"e":console.error(e.data.d);break;default:xx=ab2str(e.data).replace(/\n/g,"\\n").replace(/\r/g,"\\r"),r(JSON.parse(xx))}},rABS){var a=s2ab(e);t.postMessage(a[1],[a[1]])}else t.postMessage(e,[e])}function xw(e,r){transferable?xw_xfer(e,r):xw_noxfer(e,r)}function to_json(e){var r={};return e.SheetNames.forEach(function(t){var a,o=e.Sheets[t],n=X.utils.sheet_to_row_object_array(o);for(var s in o)o.hasOwnProperty(s)&&(a=o[s]);n.length>0&&(r=n)}),r}function process_wb(e){data=$.parseJSON(JSON.stringify(to_json(e),2,2))}function handleFile(e){var r=e.target.files,t=r[0],a=new FileReader;t.name;a.onload=function(e){var r=e.target.result;if(use_worker)xw(r,process_wb);else{var t;if(rABS)t=X.read(r,{type:"binary"});else{var a=fixdata(r);t=X.read(btoa(a),{type:"base64"})}process_wb(t)}},rABS?a.readAsBinaryString(t):a.readAsArrayBuffer(t)}var X=XLSX,XW={msg:"xlsx",rABS:"../../vendor/js-xlsx/xlsxworker2.js",norABS:"../../vendor/js-xlsx/xlsxworker1.js",noxfer:"../../vendor/js-xlsx/xlsxworker.js"},data,rABS="undefined"!=typeof FileReader&&"undefined"!=typeof FileReader.prototype&&"undefined"!=typeof FileReader.prototype.readAsBinaryString,use_worker=!!window.location.href.match("http://"),transferable=use_worker;require.config({paths:{echarts:"vendor/echarts"}}),$.fn.drawChart=function(e){var r=$(this);return charts=new $.charts(r,e),charts},$.charts=function(e,r){var t=$.extend({styles:$.charts.defaultStyles},r),a=this.getStyle(t),o=$.extend({style:a},r);this.selector=e,this.init(e,o)},$.extend($.charts,{defaults:{tree:{toolbox:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},restore:{show:!0},saveAsImage:{show:!0}}},series:[{name:"树图",type:"tree",orient:"horizontal",rootLocation:{x:50,y:"50%"},nodePadding:25,layerPadding:100,hoverable:!1,roam:!0,symbolSize:6,itemStyle:{normal:{color:"#4883b4",label:{show:!0,position:"right",formatter:"{b}",textStyle:{color:"#000",fontSize:5}},lineStyle:{color:"#ccc",type:"broken"}},emphasis:{color:"#4883b4",label:{show:!1},borderWidth:0}},data:[]}]},wordCloud:{tooltip:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},restore:{show:!0},saveAsImage:{show:!0}}},series:[{name:"字符雲",type:"wordCloud",size:["80%","80%"],textRotation:[0,45,90,-45],textPadding:0,autoSize:{enable:!0,minSize:14},data:[]}]},pie:{tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",x:"left",data:[]},toolbox:{show:!0,feature:{dataView:{show:!1,readOnly:!1},magicType:{show:!0,type:["pie","funnel"],option:{funnel:{x:"25%",width:"50%",funnelAlign:"left",max:1548}}},restore:{show:!0},saveAsImage:{show:!0}}},series:[{name:"餅圖",type:"pie",radius:"55%",itemStyle:{normal:{label:{position:"outer",formatter:function(e){return e.percent?e.name+e.percent+"%\n":e.name+e.value}}}},data:[]}]},bar:{toolbox:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"",data:[],axisLabel:{show:!0,interval:0,rotate:45,margin:8,formatter:"{value}"}}],yAxis:[{type:"value",name:[],axisLabel:{formatter:"{value}"}}],series:[{name:"",type:"bar",data:[]}]}},prototype:{getStyle:function(e){var r,t,a=e.styles,o=e.customStyle;for(t in a)t===o&&(r=a[t]);return r},init:function(e,r){var t=($(this),e.attr("id")),a=r,o=a.type;switch(o){case"tree":$.charts.prototype.drawTree(t,a);break;case"pie":$.charts.prototype.drawPie(t,a);break;case"wordCloud":$.charts.prototype.drawWordCloud(t,a);break;case"bar":$.charts.prototype.drawBar(t,a)}},drawTree:function(e,r){var t=$.extend($.charts.defaults.tree,r||{});require(["echarts","echarts/chart/tree"],function(r){var a=r.init(document.getElementById(e),"macarons");t.series[0].data=t.seriesData,a.setOption(t)})},drawWordCloud:function(e,r){var t=$.extend($.charts.defaults.wordCloud,r||{});require(["echarts","echarts/chart/wordCloud"],function(r){var a,o,n=r.init(document.getElementById(e),"macarons");for(a=0;a<t.seriesData.length;a++)o=t.seriesData[a],t.style&&(o.itemStyle=t.style());t.series[0].data=t.seriesData,n.setOption(t)})},drawPie:function(e,r){var t=$.extend($.charts.defaults.pie,r||{});require(["echarts","echarts/chart/pie","echarts/chart/funnel"],function(r){var a,o,n=r.init(document.getElementById(e),"infographic");for(a=0;a<t.seriesData.length;a++)o=t.seriesData[a],t.style&&(o.itemStyle=t.style());t.series[0].data=t.seriesData,n.setOption(t)})},drawBar:function(e,r){var t=$.extend($.charts.defaults.bar,r||{});require(["echarts","echarts/chart/bar","echarts/chart/line"],function(r){var a,o,n=r.init(document.getElementById(e),"infographic");for(a=0;a<t.seriesData.length;a++)o=t.seriesData[a],t.style&&(o.itemStyle=t.style());t.series[0].data=t.seriesData,n.setOption(t)})}},defaultStyles:{darkStyle:function(){return{normal:{color:"rgb("+[Math.round(160*Math.random()),Math.round(160*Math.random()),Math.round(160*Math.random())].join(",")+")"}}},rainbowStyle:function(){return{normal:{color:function(e){var r=["#C1232B","#B5C334","#FCCE10","#E87C25","#27727B","#FE8463","#9BCA63","#FAD860","#F3A43B","#60C0DD","#D7504B","#C6E579","#F4E001","#F0805A","#26C0C0"];return r[e.dataIndex]},textStyle:{fontFamily:"Microsoft Yahei, Arial, Verdana, sans-serif"}}}},wairoStyle:function(){return{normal:{color:function(e){var r=["#89C3EB","#83F6E8","#838BF6","#71C6D4","#7192D4","#AEDEFF","#9E773D","#EBC389","#4D7D9E","#7AAED1","#3F596B","#90CEF8"];return r[e.dataIndex]},textStyle:{fontFamily:"Microsoft Yahei, Arial, Verdana, sans-serif"}}}}},addStyle:function(e){$.extend($.charts.defaultStyles,e)}});